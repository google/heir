// Test emit-verilog supporting lowering multiple global memref constants and
// lookups to Verilog arrays and accessors.

// RUN: heir-translate %s --emit-verilog > %t
// RUN: FileCheck %s < %t

module {
  memref.global "private" constant @__constant_513xi16 : memref<513xi16> = dense<"0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000100010001000100010001000200020002000200020003000300030004000400050005000600060007000800080009000A000B000C000E000F00110012001400160018001A001D002000230026002A002E00330038003D00430049005000580061006A0074007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F007F00">
  memref.global "private" constant @__constant_513xi16_0 : memref<513xi16> = dense<"0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000100010001000100010001000100020002000200020003000300030004000400040005000500060007000700080009000A000B000C000D000E001000110013001500170019001C001E002100240028002C00300035003A00400046004C0054005C0065006F00790085009200A000AF00C000D300E700FD00150030004D006D009100B700E100100042007A00B700FA0043009300EB004C00B5002900A8003300CC0073002A00F300CF00C000C900EB00290085000300A500700066008D00E9007F0054007000D7009200AA0025000F0072005900D200E900AF0034008B00C700FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00">

  func.func @main(%arg0: i9) -> i16 {
    %1 = memref.get_global @__constant_513xi16 : memref<513xi16>
    %2 = memref.get_global @__constant_513xi16_0 : memref<513xi16>
    %3 = arith.index_cast %arg0 : i9 to index
    %4 = affine.load %1[%3] : memref<513xi16>
    %5 = affine.load %2[%3] : memref<513xi16>
    %6 = arith.addi %4, %5 : i16
    return %6 : i16
  }
}

// CHECK:      module main
// CHECK-NEXT:   input wire signed [8:0] [[ARG:.*]],
// CHECK-NEXT:   output wire signed [15:0] [[OUT:.*]]
// CHECK-NEXT: );
// CHECK-NEXT: wire signed [8207:0] [[V2:.*]];
// CHECK-NEXT: wire signed [8207:0] [[V3:.*]];
// CHECK-NEXT: wire signed [15:0] [[V4:.*]];
// CHECK-NEXT: wire signed [15:0] [[V5:.*]];
// CHECK-NEXT: wire signed [15:0] [[V6:.*]];
// CHECK-NEXT: assign [[V2]] = 8208'h{{[A-Z0-9]+}};
// CHECK-NEXT: assign [[V3]] = 8208'h{{[A-Z0-9]+}};
// CHECK-EMPTY:
// CHECK-NEXT:  assign [[V4]] = [[V2]][15 + 16 * [[ARG]] : 16 * [[ARG]]];
// CHECK-NEXT:  assign [[V5]] = [[V3]][15 + 16 * [[ARG]] : 16 * [[ARG]]];
// CHECK-NEXT:  assign [[V6]] = [[V4]] + [[V5]];
// CHECK-NEXT:  assign [[OUT]] = [[V6]];
// CHECK:      endmodule
