package resnet10

import (
	"fmt"
	"github.com/tuneinsight/lattigo/v6/circuits/ckks/lintrans"
	"github.com/tuneinsight/lattigo/v6/core/rlwe"
	"github.com/tuneinsight/lattigo/v6/ring"
	"github.com/tuneinsight/lattigo/v6/schemes/ckks"
	"testing"
	"time"
)

// MakeFlattenedOnes creates a slice of float64 filled with 1.0s.
// The size of the slice is determined by the product of the input 2D dimensions (rows * cols).
func MakeFlattenedOnes(rows, cols int) []float64 {
	size := rows * cols
	tensor := make([]float64, size)
	for i := range tensor {
		tensor[i] = 1.0
	}
	return tensor
}

func makeRange(n uint64) []uint64 {
	a := make([]uint64, n)
	for i := range a {
		a[i] = uint64(i)
	}
	return a
}

func generateLintransGaloisKeys(param ckks.Parameters, diagonalIndices []int) []uint64 {
	lintrans_params := lintrans.Parameters{
		DiagonalsIndexList:        diagonalIndices,
		LevelQ:                    5,
		LevelP:                    param.MaxLevelP(),
		Scale:                     rlwe.NewScale(param.Q()[5]),
		LogDimensions:             ring.Dimensions{Rows: 0, Cols: 12}, // 1x4096
		LogBabyStepGiantStepRatio: 2,
	}
	lt := lintrans.NewTransformation(param, lintrans_params)
	return lt.GaloisElements(param)
}

func TestMLP(t *testing.T) {
	log_n := 16
	num_slots := 1 << (log_n - 1)

	// Input is arbitrary, doesn't matter since we're just testing
	// performance
	input_clear := make([]float64, num_slots)
	for i := range input_clear {
		input_clear[i] = 1.0
	}

	// Function args:
	//
	// %ct: encrypted input,
	// % arg0: tensor<198x32768xf64>
	// % arg1: tensor<288x32768xf64>
	// % arg2: tensor<288x32768xf64>
	// % arg3: tensor<256x32768xf64>
	// % arg4: tensor<784x32768xf64>
	// % arg5: tensor<64x32768xf64>
	// % arg6: tensor<648x32768xf64>
	// % arg7: tensor<1800x32768xf64>
	// % arg8: tensor<200x32768xf64>
	// % arg9: tensor<89x32768xf64>
	// % arg10: tensor<32768xf64>
	//
	// Cleartext args are converted to row-major flattened 1D slices. Data
	// is arbitrary because we're just testing perf.
	arg0 := MakeFlattenedOnes(198, num_slots)
	arg1 := MakeFlattenedOnes(288, num_slots)
	arg2 := MakeFlattenedOnes(288, num_slots)
	arg3 := MakeFlattenedOnes(256, num_slots)
	arg4 := MakeFlattenedOnes(784, num_slots)
	arg5 := MakeFlattenedOnes(64, num_slots)
	arg6 := MakeFlattenedOnes(648, num_slots)
	arg7 := MakeFlattenedOnes(1800, num_slots)
	arg8 := MakeFlattenedOnes(200, num_slots)
	arg9 := MakeFlattenedOnes(89, num_slots)
	arg10 := MakeFlattenedOnes(1, num_slots)

	// These parameters should match the mlir file, though due to the weird
	// nature of this test, this is the source of truth for what is used,
	// not the mlir file.
	param, err := ckks.NewParametersFromLiteral(ckks.ParametersLiteral{
		LogN:            log_n,
		Q:               []uint64{36028797019488257, 1099512938497, 1099510054913, 1099507695617, 1099515691009, 1099516870657, 1099506515969, 1099504549889, 1099503894529, 1099503370241, 1099502714881},
		P:               []uint64{2305843009211596801, 2305843009210023937, 2305843009208713217},
		LogDefaultScale: 40,
	})
	if err != nil {
		panic(err)
	}

	encoder := ckks.NewEncoder(param)
	kgen := rlwe.NewKeyGenerator(param)
	sk, pk := kgen.GenKeyPairNew()
	encryptor := rlwe.NewEncryptor(param, pk)
	decryptor := rlwe.NewDecryptor(param, sk)
	rk := kgen.GenRelinearizationKeyNew(sk)

	// We have to do this once for each distinct linear_transform op to
	// ensure we generate all the galois keys needed by lattigo
	galEls := []uint64{}
	indices1 := []int{0, 1, 31, 32, 33, 991, 992, 993, 1023, 1024, 1025, 1055, 1056, 1057, 2015, 2016, 2017, 2047, 2048, 2049, 2079, 2080, 2081, 13279, 13280, 13281, 13311, 13312, 13313, 13343, 13344, 13345, 14303, 14304, 14305, 14335, 14336, 14337, 14367, 14368, 14369, 15327, 15328, 15329, 15359, 15360, 15361, 15391, 15392, 15393, 16351, 16352, 16353, 16383, 16384, 16385, 16415, 16416, 16417, 17375, 17376, 17377, 17407, 17408, 17409, 17439, 17440, 17441, 18399, 18400, 18401, 18431, 18432, 18433, 18463, 18464, 18465, 19423, 19424, 19425, 19455, 19456, 19457, 19487, 19488, 19489, 20447, 20448, 20449, 20479, 20480, 20481, 20511, 20512, 20513, 21471, 21472, 21473, 21503, 21504, 21505, 21535, 21536, 21537, 22495, 22496, 22497, 22527, 22528, 22529, 22559, 22560, 22561, 23519, 23520, 23521, 23551, 23552, 23553, 23583, 23584, 23585, 24543, 24544, 24545, 24575, 24576, 24577, 24607, 24608, 24609, 25567, 25568, 25569, 25599, 25600, 25601, 25631, 25632, 25633, 26591, 26592, 26593, 26623, 26624, 26625, 26655, 26656, 26657, 27615, 27616, 27617, 27647, 27648, 27649, 27679, 27680, 27681, 28639, 28640, 28641, 28671, 28672, 28673, 28703, 28704, 28705, 29663, 29664, 29665, 29695, 29696, 29697, 29727, 29728, 29729, 30687, 30688, 30689, 30719, 30720, 30721, 30751, 30752, 30753, 31711, 31712, 31713, 31743, 31744, 31745, 31775, 31776, 31777, 32735, 32736, 32737, 32767}
	indices2 := []int{0, 1, 31, 32, 33, 991, 992, 993, 1023, 1024, 1025, 1055, 1056, 1057, 2015, 2016, 2017, 2047, 2048, 2049, 2079, 2080, 2081, 3039, 3040, 3041, 3071, 3072, 3073, 3103, 3104, 3105, 4063, 4064, 4065, 4095, 4096, 4097, 4127, 4128, 4129, 5087, 5088, 5089, 5119, 5120, 5121, 5151, 5152, 5153, 6111, 6112, 6113, 6143, 6144, 6145, 6175, 6176, 6177, 7135, 7136, 7137, 7167, 7168, 7169, 7199, 7200, 7201, 8159, 8160, 8161, 8191, 8192, 8193, 8223, 8224, 8225, 9183, 9184, 9185, 9215, 9216, 9217, 9247, 9248, 9249, 10207, 10208, 10209, 10239, 10240, 10241, 10271, 10272, 10273, 11231, 11232, 11233, 11263, 11264, 11265, 11295, 11296, 11297, 12255, 12256, 12257, 12287, 12288, 12289, 12319, 12320, 12321, 13279, 13280, 13281, 13311, 13312, 13313, 13343, 13344, 13345, 14303, 14304, 14305, 14335, 14336, 14337, 14367, 14368, 14369, 15327, 15328, 15329, 15359, 15360, 15361, 15391, 15392, 15393, 16351, 16352, 16353, 16383, 16384, 16385, 16415, 16416, 16417, 17375, 17376, 17377, 17407, 17408, 17409, 17439, 17440, 17441, 18399, 18400, 18401, 18431, 18432, 18433, 18463, 18464, 18465, 19423, 19424, 19425, 19455, 19456, 19457, 19487, 19488, 19489, 20447, 20448, 20449, 20479, 20480, 20481, 20511, 20512, 20513, 21471, 21472, 21473, 21503, 21504, 21505, 21535, 21536, 21537, 22495, 22496, 22497, 22527, 22528, 22529, 22559, 22560, 22561, 23519, 23520, 23521, 23551, 23552, 23553, 23583, 23584, 23585, 24543, 24544, 24545, 24575, 24576, 24577, 24607, 24608, 24609, 25567, 25568, 25569, 25599, 25600, 25601, 25631, 25632, 25633, 26591, 26592, 26593, 26623, 26624, 26625, 26655, 26656, 26657, 27615, 27616, 27617, 27647, 27648, 27649, 27679, 27680, 27681, 28639, 28640, 28641, 28671, 28672, 28673, 28703, 28704, 28705, 29663, 29664, 29665, 29695, 29696, 29697, 29727, 29728, 29729, 30687, 30688, 30689, 30719, 30720, 30721, 30751, 30752, 30753, 31711, 31712, 31713, 31743, 31744, 31745, 31775, 31776, 31777, 32735, 32736, 32737, 32767}
	indices3 := []int{0, 1, 31, 32, 33, 991, 992, 993, 1023, 1024, 1025, 1055, 1056, 1057, 2015, 2016, 2017, 2047, 2048, 2049, 2079, 2080, 2081, 3039, 3040, 3041, 3071, 3072, 3073, 3103, 3104, 3105, 4063, 4064, 4065, 4095, 4096, 4097, 4127, 4128, 4129, 5087, 5088, 5089, 5119, 5120, 5121, 5151, 5152, 5153, 6111, 6112, 6113, 6143, 6144, 6145, 6175, 6176, 6177, 7135, 7136, 7137, 7167, 7168, 7169, 7199, 7200, 7201, 8159, 8160, 8161, 8191, 8192, 8193, 8223, 8224, 8225, 9183, 9184, 9185, 9215, 9216, 9217, 9247, 9248, 9249, 10207, 10208, 10209, 10239, 10240, 10241, 10271, 10272, 10273, 11231, 11232, 11233, 11263, 11264, 11265, 11295, 11296, 11297, 12255, 12256, 12257, 12287, 12288, 12289, 12319, 12320, 12321, 13279, 13280, 13281, 13311, 13312, 13313, 13343, 13344, 13345, 14303, 14304, 14305, 14335, 14336, 14337, 14367, 14368, 14369, 15327, 15328, 15329, 15359, 15360, 15361, 15391, 15392, 15393, 16351, 16352, 16353, 16383, 16384, 16385, 16415, 16416, 16417, 17375, 17376, 17377, 17407, 17408, 17409, 17439, 17440, 17441, 18399, 18400, 18401, 18431, 18432, 18433, 18463, 18464, 18465, 19423, 19424, 19425, 19455, 19456, 19457, 19487, 19488, 19489, 20447, 20448, 20449, 20479, 20480, 20481, 20511, 20512, 20513, 21471, 21472, 21473, 21503, 21504, 21505, 21535, 21536, 21537, 22495, 22496, 22497, 22527, 22528, 22529, 22559, 22560, 22561, 23519, 23520, 23521, 23551, 23552, 23553, 23583, 23584, 23585, 24543, 24544, 24545, 24575, 24576, 24577, 24607, 24608, 24609, 25567, 25568, 25569, 25599, 25600, 25601, 25631, 25632, 25633, 26591, 26592, 26593, 26623, 26624, 26625, 26655, 26656, 26657, 27615, 27616, 27617, 27647, 27648, 27649, 27679, 27680, 27681, 28639, 28640, 28641, 28671, 28672, 28673, 28703, 28704, 28705, 29663, 29664, 29665, 29695, 29696, 29697, 29727, 29728, 29729, 30687, 30688, 30689, 30719, 30720, 30721, 30751, 30752, 30753, 31711, 31712, 31713, 31743, 31744, 31745, 31775, 31776, 31777, 32735, 32736, 32737, 32767}
	indices4 := []int{0, 1, 30, 31, 32, 33, 958, 959, 960, 961, 990, 991, 992, 993, 1022, 1023, 1024, 1025, 1054, 1055, 1056, 1057, 1982, 1983, 1984, 1985, 2014, 2015, 2016, 2017, 2046, 2047, 2048, 2049, 2078, 2079, 2080, 2081, 3006, 3007, 3008, 3009, 3038, 3039, 3040, 3041, 3070, 3071, 3072, 3073, 3102, 3103, 3104, 3105, 4030, 4031, 4032, 4033, 4062, 4063, 4064, 4065, 4094, 4095, 4096, 4097, 4126, 4127, 4128, 4129, 5054, 5055, 5056, 5057, 5086, 5087, 5088, 5089, 5118, 5119, 5120, 5121, 5150, 5151, 5152, 5153, 6078, 6079, 6080, 6081, 6110, 6111, 6112, 6113, 6142, 6143, 6144, 6145, 6174, 6175, 6176, 6177, 7102, 7103, 7104, 7105, 7134, 7135, 7136, 7137, 7166, 7167, 7168, 7169, 7198, 7199, 7200, 7201, 8126, 8127, 8128, 8129, 8158, 8159, 8160, 8161, 8190, 8191, 8192, 8193, 8222, 8223, 8224, 8225, 9150, 9151, 9152, 9153, 9182, 9183, 9184, 9185, 9214, 9215, 9216, 9217, 9246, 9247, 9248, 9249, 10174, 10175, 10176, 10177, 10206, 10207, 10208, 10209, 10238, 10239, 10240, 10241, 10270, 10271, 10272, 10273, 11198, 11199, 11200, 11201, 11230, 11231, 11232, 11233, 11262, 11263, 11264, 11265, 11294, 11295, 11296, 11297, 12222, 12223, 12224, 12225, 12254, 12255, 12256, 12257, 12286, 12287, 12288, 12289, 12318, 12319, 12320, 12321, 13246, 13247, 13248, 13249, 13278, 13279, 13280, 13281, 13310, 13311, 13312, 13313, 13342, 13343, 13344, 13345, 14270, 14271, 14272, 14273, 14302, 14303, 14304, 14305, 14334, 14335, 14336, 14337, 14366, 14367, 14368, 14369, 15294, 15295, 15296, 15297, 15326, 15327, 15328, 15329, 15358, 15359, 15360, 15361, 15390, 15391, 15392, 15393, 16318, 16319, 16320, 16321, 16350, 16351, 16352, 16353, 16382, 16383}
	indices5 := []int{0, 1, 2, 3, 29, 30, 31, 32, 33, 34, 35, 61, 62, 63, 64, 65, 66, 67, 93, 94, 95, 96, 97, 98, 99, 925, 926, 927, 928, 929, 930, 931, 957, 958, 959, 960, 961, 962, 963, 989, 990, 991, 992, 993, 994, 995, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2077, 2078, 2079, 2080, 2081, 2082, 2083, 2109, 2110, 2111, 2112, 2113, 2114, 2115, 2141, 2142, 2143, 2144, 2145, 2146, 2147, 2973, 2974, 2975, 2976, 2977, 2978, 2979, 3005, 3006, 3007, 3008, 3009, 3010, 3011, 3037, 3038, 3039, 3040, 3041, 3042, 3043, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3101, 3102, 3103, 3104, 3105, 3106, 3107, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3165, 3166, 3167, 3168, 3169, 3170, 3171, 3997, 3998, 3999, 4000, 4001, 4002, 4003, 4029, 4030, 4031, 4032, 4033, 4034, 4035, 4061, 4062, 4063, 4064, 4065, 4066, 4067, 4093, 4094, 4095, 4096, 4097, 4098, 4099, 4125, 4126, 4127, 4128, 4129, 4130, 4131, 4157, 4158, 4159, 4160, 4161, 4162, 4163, 4189, 4190, 4191, 4192, 4193, 4194, 4195, 5021, 5022, 5023, 5024, 5025, 5026, 5027, 5053, 5054, 5055, 5056, 5057, 5058, 5059, 5085, 5086, 5087, 5088, 5089, 5090, 5091, 5117, 5118, 5119, 5120, 5121, 5122, 5123, 5149, 5150, 5151, 5152, 5153, 5154, 5155, 5181, 5182, 5183, 5184, 5185, 5186, 5187, 5213, 5214, 5215, 5216, 5217, 5218, 5219, 6045, 6046, 6047, 6048, 6049, 6050, 6051, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6109, 6110, 6111, 6112, 6113, 6114, 6115, 6141, 6142, 6143, 6144, 6145, 6146, 6147, 6173, 6174, 6175, 6176, 6177, 6178, 6179, 6205, 6206, 6207, 6208, 6209, 6210, 6211, 6237, 6238, 6239, 6240, 6241, 6242, 6243, 7069, 7070, 7071, 7072, 7073, 7074, 7075, 7101, 7102, 7103, 7104, 7105, 7106, 7107, 7133, 7134, 7135, 7136, 7137, 7138, 7139, 7165, 7166, 7167, 7168, 7169, 7170, 7171, 7197, 7198, 7199, 7200, 7201, 7202, 7203, 7229, 7230, 7231, 7232, 7233, 7234, 7235, 7261, 7262, 7263, 7264, 7265, 7266, 7267, 8093, 8094, 8095, 8096, 8097, 8098, 8099, 8125, 8126, 8127, 8128, 8129, 8130, 8131, 8157, 8158, 8159, 8160, 8161, 8162, 8163, 8189, 8190, 8191, 8192, 8193, 8194, 8195, 8221, 8222, 8223, 8224, 8225, 8226, 8227, 8253, 8254, 8255, 8256, 8257, 8258, 8259, 8285, 8286, 8287, 8288, 8289, 8290, 8291, 9117, 9118, 9119, 9120, 9121, 9122, 9123, 9149, 9150, 9151, 9152, 9153, 9154, 9155, 9181, 9182, 9183, 9184, 9185, 9186, 9187, 9213, 9214, 9215, 9216, 9217, 9218, 9219, 9245, 9246, 9247, 9248, 9249, 9250, 9251, 9277, 9278, 9279, 9280, 9281, 9282, 9283, 9309, 9310, 9311, 9312, 9313, 9314, 9315, 10141, 10142, 10143, 10144, 10145, 10146, 10147, 10173, 10174, 10175, 10176, 10177, 10178, 10179, 10205, 10206, 10207, 10208, 10209, 10210, 10211, 10237, 10238, 10239, 10240, 10241, 10242, 10243, 10269, 10270, 10271, 10272, 10273, 10274, 10275, 10301, 10302, 10303, 10304, 10305, 10306, 10307, 10333, 10334, 10335, 10336, 10337, 10338, 10339, 11165, 11166, 11167, 11168, 11169, 11170, 11171, 11197, 11198, 11199, 11200, 11201, 11202, 11203, 11229, 11230, 11231, 11232, 11233, 11234, 11235, 11261, 11262, 11263, 11264, 11265, 11266, 11267, 11293, 11294, 11295, 11296, 11297, 11298, 11299, 11325, 11326, 11327, 11328, 11329, 11330, 11331, 11357, 11358, 11359, 11360, 11361, 11362, 11363, 12189, 12190, 12191, 12192, 12193, 12194, 12195, 12221, 12222, 12223, 12224, 12225, 12226, 12227, 12253, 12254, 12255, 12256, 12257, 12258, 12259, 12285, 12286, 12287, 12288, 12289, 12290, 12291, 12317, 12318, 12319, 12320, 12321, 12322, 12323, 12349, 12350, 12351, 12352, 12353, 12354, 12355, 12381, 12382, 12383, 12384, 12385, 12386, 12387, 13213, 13214, 13215, 13216, 13217, 13218, 13219, 13245, 13246, 13247, 13248, 13249, 13250, 13251, 13277, 13278, 13279, 13280, 13281, 13282, 13283, 13309, 13310, 13311, 13312, 13313, 13314, 13315, 13341, 13342, 13343, 13344, 13345, 13346, 13347, 13373, 13374, 13375, 13376, 13377, 13378, 13379, 13405, 13406, 13407, 13408, 13409, 13410, 13411, 14237, 14238, 14239, 14240, 14241, 14242, 14243, 14269, 14270, 14271, 14272, 14273, 14274, 14275, 14301, 14302, 14303, 14304, 14305, 14306, 14307, 14333, 14334, 14335, 14336, 14337, 14338, 14339, 14365, 14366, 14367, 14368, 14369, 14370, 14371, 14397, 14398, 14399, 14400, 14401, 14402, 14403, 14429, 14430, 14431, 14432, 14433, 14434, 14435, 15261, 15262, 15263, 15264, 15265, 15266, 15267, 15293, 15294, 15295, 15296, 15297, 15298, 15299, 15325, 15326, 15327, 15328, 15329, 15330, 15331, 15357, 15358, 15359, 15360, 15361, 15362, 15363, 15389, 15390, 15391, 15392, 15393, 15394, 15395, 15421, 15422, 15423, 15424, 15425, 15426, 15427, 15453, 15454, 15455, 15456, 15457, 15458, 15459, 16285, 16286, 16287, 16288, 16289, 16290, 16291, 16317, 16318, 16319, 16320, 16321, 16322, 16323, 16349, 16350, 16351, 16352, 16353, 16354, 16355, 16381, 16382, 16383}
	indices6 := []int{0, 991, 992, 1023, 1024, 2015, 2016, 2047, 2048, 3039, 3040, 3071, 3072, 4063, 4064, 4095, 4096, 5087, 5088, 5119, 5120, 6111, 6112, 6143, 6144, 7135, 7136, 7167, 7168, 8159, 8160, 8191, 8192, 9183, 9184, 9215, 9216, 10207, 10208, 10239, 10240, 11231, 11232, 11263, 11264, 12255, 12256, 12287, 12288, 13279, 13280, 13311, 13312, 14303, 14304, 14335, 14336, 15327, 15328, 15359, 15360, 16351, 16352, 16383}
	indices7 := []int{0, 1, 2, 3, 27, 28, 29, 30, 31, 32, 33, 34, 35, 59, 60, 61, 62, 63, 64, 65, 66, 67, 91, 92, 93, 94, 95, 96, 97, 98, 99, 859, 860, 861, 862, 863, 864, 865, 866, 867, 891, 892, 893, 894, 895, 896, 897, 898, 899, 923, 924, 925, 926, 927, 928, 929, 930, 931, 955, 956, 957, 958, 959, 960, 961, 962, 963, 987, 988, 989, 990, 991, 992, 993, 994, 995, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1883, 1884, 1885, 1886, 1887, 1888, 1889, 1890, 1891, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2075, 2076, 2077, 2078, 2079, 2080, 2081, 2082, 2083, 2107, 2108, 2109, 2110, 2111, 2112, 2113, 2114, 2115, 2139, 2140, 2141, 2142, 2143, 2144, 2145, 2146, 2147, 2907, 2908, 2909, 2910, 2911, 2912, 2913, 2914, 2915, 2939, 2940, 2941, 2942, 2943, 2944, 2945, 2946, 2947, 2971, 2972, 2973, 2974, 2975, 2976, 2977, 2978, 2979, 3003, 3004, 3005, 3006, 3007, 3008, 3009, 3010, 3011, 3035, 3036, 3037, 3038, 3039, 3040, 3041, 3042, 3043, 3067, 3068, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3099, 3100, 3101, 3102, 3103, 3104, 3105, 3106, 3107, 3131, 3132, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3163, 3164, 3165, 3166, 3167, 3168, 3169, 3170, 3171, 3931, 3932, 3933, 3934, 3935, 3936, 3937, 3938, 3939, 3963, 3964, 3965, 3966, 3967, 3968, 3969, 3970, 3971, 3995, 3996, 3997, 3998, 3999, 4000, 4001, 4002, 4003, 4027, 4028, 4029, 4030, 4031, 4032, 4033, 4034, 4035, 4059, 4060, 4061, 4062, 4063, 4064, 4065, 4066, 4067, 4091, 4092, 4093, 4094, 4095, 4096, 4097, 4098, 4099, 4123, 4124, 4125, 4126, 4127, 4128, 4129, 4130, 4131, 4155, 4156, 4157, 4158, 4159, 4160, 4161, 4162, 4163, 4187, 4188, 4189, 4190, 4191, 4192, 4193, 4194, 4195, 4955, 4956, 4957, 4958, 4959, 4960, 4961, 4962, 4963, 4987, 4988, 4989, 4990, 4991, 4992, 4993, 4994, 4995, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, 5027, 5051, 5052, 5053, 5054, 5055, 5056, 5057, 5058, 5059, 5083, 5084, 5085, 5086, 5087, 5088, 5089, 5090, 5091, 5115, 5116, 5117, 5118, 5119, 5120, 5121, 5122, 5123, 5147, 5148, 5149, 5150, 5151, 5152, 5153, 5154, 5155, 5179, 5180, 5181, 5182, 5183, 5184, 5185, 5186, 5187, 5211, 5212, 5213, 5214, 5215, 5216, 5217, 5218, 5219, 5979, 5980, 5981, 5982, 5983, 5984, 5985, 5986, 5987, 6011, 6012, 6013, 6014, 6015, 6016, 6017, 6018, 6019, 6043, 6044, 6045, 6046, 6047, 6048, 6049, 6050, 6051, 6075, 6076, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6107, 6108, 6109, 6110, 6111, 6112, 6113, 6114, 6115, 6139, 6140, 6141, 6142, 6143, 6144, 6145, 6146, 6147, 6171, 6172, 6173, 6174, 6175, 6176, 6177, 6178, 6179, 6203, 6204, 6205, 6206, 6207, 6208, 6209, 6210, 6211, 6235, 6236, 6237, 6238, 6239, 6240, 6241, 6242, 6243, 7003, 7004, 7005, 7006, 7007, 7008, 7009, 7010, 7011, 7035, 7036, 7037, 7038, 7039, 7040, 7041, 7042, 7043, 7067, 7068, 7069, 7070, 7071, 7072, 7073, 7074, 7075, 7099, 7100, 7101, 7102, 7103, 7104, 7105, 7106, 7107, 7131, 7132, 7133, 7134, 7135, 7136, 7137, 7138, 7139, 7163, 7164, 7165, 7166, 7167, 7168, 7169, 7170, 7171, 7195, 7196, 7197, 7198, 7199, 7200, 7201, 7202, 7203, 7227, 7228, 7229, 7230, 7231, 7232, 7233, 7234, 7235, 7259, 7260, 7261, 7262, 7263, 7264, 7265, 7266, 7267, 8027, 8028, 8029, 8030, 8031, 8032, 8033, 8034, 8035, 8059, 8060, 8061, 8062, 8063, 8064, 8065, 8066, 8067, 8091, 8092, 8093, 8094, 8095, 8096, 8097, 8098, 8099, 8123, 8124, 8125, 8126, 8127, 8128, 8129, 8130, 8131, 8155, 8156, 8157, 8158, 8159, 8160, 8161, 8162, 8163, 8187, 8188, 8189, 8190, 8191}
	indices8 := []int{0, 1, 2, 3, 4, 5, 6, 7, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 793, 794, 795, 796, 797, 798, 799, 800, 801, 802, 803, 804, 805, 806, 807, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 889, 890, 891, 892, 893, 894, 895, 896, 897, 898, 899, 900, 901, 902, 903, 921, 922, 923, 924, 925, 926, 927, 928, 929, 930, 931, 932, 933, 934, 935, 953, 954, 955, 956, 957, 958, 959, 960, 961, 962, 963, 964, 965, 966, 967, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 995, 996, 997, 998, 999, 1017, 1018, 1019, 1020, 1021, 1022, 1023, 1024, 1025, 1026, 1027, 1028, 1029, 1030, 1031, 1049, 1050, 1051, 1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061, 1062, 1063, 1081, 1082, 1083, 1084, 1085, 1086, 1087, 1088, 1089, 1090, 1091, 1092, 1093, 1094, 1095, 1113, 1114, 1115, 1116, 1117, 1118, 1119, 1120, 1121, 1122, 1123, 1124, 1125, 1126, 1127, 1145, 1146, 1147, 1148, 1149, 1150, 1151, 1152, 1153, 1154, 1155, 1156, 1157, 1158, 1159, 1177, 1178, 1179, 1180, 1181, 1182, 1183, 1184, 1185, 1186, 1187, 1188, 1189, 1190, 1191, 1209, 1210, 1211, 1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 1251, 1252, 1253, 1254, 1255, 1817, 1818, 1819, 1820, 1821, 1822, 1823, 1824, 1825, 1826, 1827, 1828, 1829, 1830, 1831, 1849, 1850, 1851, 1852, 1853, 1854, 1855, 1856, 1857, 1858, 1859, 1860, 1861, 1862, 1863, 1881, 1882, 1883, 1884, 1885, 1886, 1887, 1888, 1889, 1890, 1891, 1892, 1893, 1894, 1895, 1913, 1914, 1915, 1916, 1917, 1918, 1919, 1920, 1921, 1922, 1923, 1924, 1925, 1926, 1927, 1945, 1946, 1947, 1948, 1949, 1950, 1951, 1952, 1953, 1954, 1955, 1956, 1957, 1958, 1959, 1977, 1978, 1979, 1980, 1981, 1982, 1983, 1984, 1985, 1986, 1987, 1988, 1989, 1990, 1991, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2041, 2042, 2043, 2044, 2045, 2046, 2047, 2048, 2049, 2050, 2051, 2052, 2053, 2054, 2055, 2073, 2074, 2075, 2076, 2077, 2078, 2079, 2080, 2081, 2082, 2083, 2084, 2085, 2086, 2087, 2105, 2106, 2107, 2108, 2109, 2110, 2111, 2112, 2113, 2114, 2115, 2116, 2117, 2118, 2119, 2137, 2138, 2139, 2140, 2141, 2142, 2143, 2144, 2145, 2146, 2147, 2148, 2149, 2150, 2151, 2169, 2170, 2171, 2172, 2173, 2174, 2175, 2176, 2177, 2178, 2179, 2180, 2181, 2182, 2183, 2201, 2202, 2203, 2204, 2205, 2206, 2207, 2208, 2209, 2210, 2211, 2212, 2213, 2214, 2215, 2233, 2234, 2235, 2236, 2237, 2238, 2239, 2240, 2241, 2242, 2243, 2244, 2245, 2246, 2247, 2265, 2266, 2267, 2268, 2269, 2270, 2271, 2272, 2273, 2274, 2275, 2276, 2277, 2278, 2279, 2841, 2842, 2843, 2844, 2845, 2846, 2847, 2848, 2849, 2850, 2851, 2852, 2853, 2854, 2855, 2873, 2874, 2875, 2876, 2877, 2878, 2879, 2880, 2881, 2882, 2883, 2884, 2885, 2886, 2887, 2905, 2906, 2907, 2908, 2909, 2910, 2911, 2912, 2913, 2914, 2915, 2916, 2917, 2918, 2919, 2937, 2938, 2939, 2940, 2941, 2942, 2943, 2944, 2945, 2946, 2947, 2948, 2949, 2950, 2951, 2969, 2970, 2971, 2972, 2973, 2974, 2975, 2976, 2977, 2978, 2979, 2980, 2981, 2982, 2983, 3001, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3009, 3010, 3011, 3012, 3013, 3014, 3015, 3033, 3034, 3035, 3036, 3037, 3038, 3039, 3040, 3041, 3042, 3043, 3044, 3045, 3046, 3047, 3065, 3066, 3067, 3068, 3069, 3070, 3071, 3072, 3073, 3074, 3075, 3076, 3077, 3078, 3079, 3097, 3098, 3099, 3100, 3101, 3102, 3103, 3104, 3105, 3106, 3107, 3108, 3109, 3110, 3111, 3129, 3130, 3131, 3132, 3133, 3134, 3135, 3136, 3137, 3138, 3139, 3140, 3141, 3142, 3143, 3161, 3162, 3163, 3164, 3165, 3166, 3167, 3168, 3169, 3170, 3171, 3172, 3173, 3174, 3175, 3193, 3194, 3195, 3196, 3197, 3198, 3199, 3200, 3201, 3202, 3203, 3204, 3205, 3206, 3207, 3225, 3226, 3227, 3228, 3229, 3230, 3231, 3232, 3233, 3234, 3235, 3236, 3237, 3238, 3239, 3257, 3258, 3259, 3260, 3261, 3262, 3263, 3264, 3265, 3266, 3267, 3268, 3269, 3270, 3271, 3289, 3290, 3291, 3292, 3293, 3294, 3295, 3296, 3297, 3298, 3299, 3300, 3301, 3302, 3303, 3865, 3866, 3867, 3868, 3869, 3870, 3871, 3872, 3873, 3874, 3875, 3876, 3877, 3878, 3879, 3897, 3898, 3899, 3900, 3901, 3902, 3903, 3904, 3905, 3906, 3907, 3908, 3909, 3910, 3911, 3929, 3930, 3931, 3932, 3933, 3934, 3935, 3936, 3937, 3938, 3939, 3940, 3941, 3942, 3943, 3961, 3962, 3963, 3964, 3965, 3966, 3967, 3968, 3969, 3970, 3971, 3972, 3973, 3974, 3975, 3993, 3994, 3995, 3996, 3997, 3998, 3999, 4000, 4001, 4002, 4003, 4004, 4005, 4006, 4007, 4025, 4026, 4027, 4028, 4029, 4030, 4031, 4032, 4033, 4034, 4035, 4036, 4037, 4038, 4039, 4057, 4058, 4059, 4060, 4061, 4062, 4063, 4064, 4065, 4066, 4067, 4068, 4069, 4070, 4071, 4089, 4090, 4091, 4092, 4093, 4094, 4095, 4096, 4097, 4098, 4099, 4100, 4101, 4102, 4103, 4121, 4122, 4123, 4124, 4125, 4126, 4127, 4128, 4129, 4130, 4131, 4132, 4133, 4134, 4135, 4153, 4154, 4155, 4156, 4157, 4158, 4159, 4160, 4161, 4162, 4163, 4164, 4165, 4166, 4167, 4185, 4186, 4187, 4188, 4189, 4190, 4191, 4192, 4193, 4194, 4195, 4196, 4197, 4198, 4199, 4217, 4218, 4219, 4220, 4221, 4222, 4223, 4224, 4225, 4226, 4227, 4228, 4229, 4230, 4231, 4249, 4250, 4251, 4252, 4253, 4254, 4255, 4256, 4257, 4258, 4259, 4260, 4261, 4262, 4263, 4281, 4282, 4283, 4284, 4285, 4286, 4287, 4288, 4289, 4290, 4291, 4292, 4293, 4294, 4295, 4313, 4314, 4315, 4316, 4317, 4318, 4319, 4320, 4321, 4322, 4323, 4324, 4325, 4326, 4327, 4889, 4890, 4891, 4892, 4893, 4894, 4895, 4896, 4897, 4898, 4899, 4900, 4901, 4902, 4903, 4921, 4922, 4923, 4924, 4925, 4926, 4927, 4928, 4929, 4930, 4931, 4932, 4933, 4934, 4935, 4953, 4954, 4955, 4956, 4957, 4958, 4959, 4960, 4961, 4962, 4963, 4964, 4965, 4966, 4967, 4985, 4986, 4987, 4988, 4989, 4990, 4991, 4992, 4993, 4994, 4995, 4996, 4997, 4998, 4999, 5017, 5018, 5019, 5020, 5021, 5022, 5023, 5024, 5025, 5026, 5027, 5028, 5029, 5030, 5031, 5049, 5050, 5051, 5052, 5053, 5054, 5055, 5056, 5057, 5058, 5059, 5060, 5061, 5062, 5063, 5081, 5082, 5083, 5084, 5085, 5086, 5087, 5088, 5089, 5090, 5091, 5092, 5093, 5094, 5095, 5113, 5114, 5115, 5116, 5117, 5118, 5119, 5120, 5121, 5122, 5123, 5124, 5125, 5126, 5127, 5145, 5146, 5147, 5148, 5149, 5150, 5151, 5152, 5153, 5154, 5155, 5156, 5157, 5158, 5159, 5177, 5178, 5179, 5180, 5181, 5182, 5183, 5184, 5185, 5186, 5187, 5188, 5189, 5190, 5191, 5209, 5210, 5211, 5212, 5213, 5214, 5215, 5216, 5217, 5218, 5219, 5220, 5221, 5222, 5223, 5241, 5242, 5243, 5244, 5245, 5246, 5247, 5248, 5249, 5250, 5251, 5252, 5253, 5254, 5255, 5273, 5274, 5275, 5276, 5277, 5278, 5279, 5280, 5281, 5282, 5283, 5284, 5285, 5286, 5287, 5305, 5306, 5307, 5308, 5309, 5310, 5311, 5312, 5313, 5314, 5315, 5316, 5317, 5318, 5319, 5337, 5338, 5339, 5340, 5341, 5342, 5343, 5344, 5345, 5346, 5347, 5348, 5349, 5350, 5351, 5913, 5914, 5915, 5916, 5917, 5918, 5919, 5920, 5921, 5922, 5923, 5924, 5925, 5926, 5927, 5945, 5946, 5947, 5948, 5949, 5950, 5951, 5952, 5953, 5954, 5955, 5956, 5957, 5958, 5959, 5977, 5978, 5979, 5980, 5981, 5982, 5983, 5984, 5985, 5986, 5987, 5988, 5989, 5990, 5991, 6009, 6010, 6011, 6012, 6013, 6014, 6015, 6016, 6017, 6018, 6019, 6020, 6021, 6022, 6023, 6041, 6042, 6043, 6044, 6045, 6046, 6047, 6048, 6049, 6050, 6051, 6052, 6053, 6054, 6055, 6073, 6074, 6075, 6076, 6077, 6078, 6079, 6080, 6081, 6082, 6083, 6084, 6085, 6086, 6087, 6105, 6106, 6107, 6108, 6109, 6110, 6111, 6112, 6113, 6114, 6115, 6116, 6117, 6118, 6119, 6137, 6138, 6139, 6140, 6141, 6142, 6143, 6144, 6145, 6146, 6147, 6148, 6149, 6150, 6151, 6169, 6170, 6171, 6172, 6173, 6174, 6175, 6176, 6177, 6178, 6179, 6180, 6181, 6182, 6183, 6201, 6202, 6203, 6204, 6205, 6206, 6207, 6208, 6209, 6210, 6211, 6212, 6213, 6214, 6215, 6233, 6234, 6235, 6236, 6237, 6238, 6239, 6240, 6241, 6242, 6243, 6244, 6245, 6246, 6247, 6265, 6266, 6267, 6268, 6269, 6270, 6271, 6272, 6273, 6274, 6275, 6276, 6277, 6278, 6279, 6297, 6298, 6299, 6300, 6301, 6302, 6303, 6304, 6305, 6306, 6307, 6308, 6309, 6310, 6311, 6329, 6330, 6331, 6332, 6333, 6334, 6335, 6336, 6337, 6338, 6339, 6340, 6341, 6342, 6343, 6361, 6362, 6363, 6364, 6365, 6366, 6367, 6368, 6369, 6370, 6371, 6372, 6373, 6374, 6375, 6937, 6938, 6939, 6940, 6941, 6942, 6943, 6944, 6945, 6946, 6947, 6948, 6949, 6950, 6951, 6969, 6970, 6971, 6972, 6973, 6974, 6975, 6976, 6977, 6978, 6979, 6980, 6981, 6982, 6983, 7001, 7002, 7003, 7004, 7005, 7006, 7007, 7008, 7009, 7010, 7011, 7012, 7013, 7014, 7015, 7033, 7034, 7035, 7036, 7037, 7038, 7039, 7040, 7041, 7042, 7043, 7044, 7045, 7046, 7047, 7065, 7066, 7067, 7068, 7069, 7070, 7071, 7072, 7073, 7074, 7075, 7076, 7077, 7078, 7079, 7097, 7098, 7099, 7100, 7101, 7102, 7103, 7104, 7105, 7106, 7107, 7108, 7109, 7110, 7111, 7129, 7130, 7131, 7132, 7133, 7134, 7135, 7136, 7137, 7138, 7139, 7140, 7141, 7142, 7143, 7161, 7162, 7163, 7164, 7165, 7166, 7167, 7168, 7169, 7170, 7171, 7172, 7173, 7174, 7175, 7193, 7194, 7195, 7196, 7197, 7198, 7199, 7200, 7201, 7202, 7203, 7204, 7205, 7206, 7207, 7225, 7226, 7227, 7228, 7229, 7230, 7231, 7232, 7233, 7234, 7235, 7236, 7237, 7238, 7239, 7257, 7258, 7259, 7260, 7261, 7262, 7263, 7264, 7265, 7266, 7267, 7268, 7269, 7270, 7271, 7289, 7290, 7291, 7292, 7293, 7294, 7295, 7296, 7297, 7298, 7299, 7300, 7301, 7302, 7303, 7321, 7322, 7323, 7324, 7325, 7326, 7327, 7328, 7329, 7330, 7331, 7332, 7333, 7334, 7335, 7353, 7354, 7355, 7356, 7357, 7358, 7359, 7360, 7361, 7362, 7363, 7364, 7365, 7366, 7367, 7385, 7386, 7387, 7388, 7389, 7390, 7391, 7392, 7393, 7394, 7395, 7396, 7397, 7398, 7399, 7961, 7962, 7963, 7964, 7965, 7966, 7967, 7968, 7969, 7970, 7971, 7972, 7973, 7974, 7975, 7993, 7994, 7995, 7996, 7997, 7998, 7999, 8000, 8001, 8002, 8003, 8004, 8005, 8006, 8007, 8025, 8026, 8027, 8028, 8029, 8030, 8031, 8032, 8033, 8034, 8035, 8036, 8037, 8038, 8039, 8057, 8058, 8059, 8060, 8061, 8062, 8063, 8064, 8065, 8066, 8067, 8068, 8069, 8070, 8071, 8089, 8090, 8091, 8092, 8093, 8094, 8095, 8096, 8097, 8098, 8099, 8100, 8101, 8102, 8103, 8121, 8122, 8123, 8124, 8125, 8126, 8127, 8128, 8129, 8130, 8131, 8132, 8133, 8134, 8135, 8153, 8154, 8155, 8156, 8157, 8158, 8159, 8160, 8161, 8162, 8163, 8164, 8165, 8166, 8167, 8185, 8186, 8187, 8188, 8189, 8190, 8191}
	indices9 := []int{0, 1, 29, 30, 31, 32, 33, 925, 926, 927, 928, 929, 957, 958, 959, 960, 961, 989, 990, 991, 992, 993, 1021, 1022, 1023, 1024, 1025, 1053, 1054, 1055, 1056, 1057, 1949, 1950, 1951, 1952, 1953, 1981, 1982, 1983, 1984, 1985, 2013, 2014, 2015, 2016, 2017, 2045, 2046, 2047, 2048, 2049, 2077, 2078, 2079, 2080, 2081, 2973, 2974, 2975, 2976, 2977, 3005, 3006, 3007, 3008, 3009, 3037, 3038, 3039, 3040, 3041, 3069, 3070, 3071, 3072, 3073, 3101, 3102, 3103, 3104, 3105, 3997, 3998, 3999, 4000, 4001, 4029, 4030, 4031, 4032, 4033, 4061, 4062, 4063, 4064, 4065, 4093, 4094, 4095, 4096, 4097, 4125, 4126, 4127, 4128, 4129, 5021, 5022, 5023, 5024, 5025, 5053, 5054, 5055, 5056, 5057, 5085, 5086, 5087, 5088, 5089, 5117, 5118, 5119, 5120, 5121, 5149, 5150, 5151, 5152, 5153, 6045, 6046, 6047, 6048, 6049, 6077, 6078, 6079, 6080, 6081, 6109, 6110, 6111, 6112, 6113, 6141, 6142, 6143, 6144, 6145, 6173, 6174, 6175, 6176, 6177, 7069, 7070, 7071, 7072, 7073, 7101, 7102, 7103, 7104, 7105, 7133, 7134, 7135, 7136, 7137, 7165, 7166, 7167, 7168, 7169, 7197, 7198, 7199, 7200, 7201, 8093, 8094, 8095, 8096, 8097, 8125, 8126, 8127, 8128, 8129, 8157, 8158, 8159, 8160, 8161, 8189, 8190, 8191}
	indices10 := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 32759, 32760, 32761, 32762, 32763, 32764, 32765, 32766, 32767}

	galEls = append(galEls, generateLintransGaloisKeys(param, indices1)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices2)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices3)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices4)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices5)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices6)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices7)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices8)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices9)...)
	galEls = append(galEls, generateLintransGaloisKeys(param, indices10)...)

	// Manually add Galois key for extra rotation indices used in the
	// mlir file, outside of linear_transform
	//
	// For some reason I need to manually add rotation keys used in
	// linear_transform! That should have been handled by the above code...
	rotIndices := []uint64{16384, 8192}
	// fmt.Printf("Adding extra rot indices: %v\n", rotIndices)

	for _, rotIndex := range rotIndices {
		galoisElement := uint64(1)
		for j := uint64(0); j < rotIndex; j++ {
			galoisElement = (galoisElement * 5) % (1 << (log_n + 1))
		}
		galEls = append(galEls, galoisElement)
	}
	fmt.Printf("Final galEls: %v\n", galEls)

	evk := rlwe.NewMemEvaluationKeySet(rk, kgen.GenGaloisKeysNew(galEls, sk)...)
	evaluator := ckks.NewEvaluator(param, evk)

	pt := ckks.NewPlaintext(param, param.MaxLevel())
	encoder.Encode(input_clear, pt)
	ct_input, err25 := encryptor.EncryptNew(pt)
	if err25 != nil {
		panic(err25)
	}

	startTime := time.Now()
	result_ct := resnet10(evaluator, param, encoder, ct_input, arg0, arg1,
		arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10)
	duration := time.Since(startTime)
	fmt.Printf("MLP call took: %v\n", duration)
	result_pt := decryptor.DecryptNew(result_ct)
	result_float64 := make([]float64, num_slots)
	encoder.Decode(result_pt, result_float64)
}
